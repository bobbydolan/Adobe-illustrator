// Select active artboard content
// doc.selectObjectsOnActiveArtboard();

// //create a new document of size 100x100 points
// var doc = app.documents.add( null , 80,80);


// Copy Selection
app.executeMenuCommand('copy');


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// Create New Doc
var newDoc = app.documents.add();


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// Activate Doc 
newDoc.activate();


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// Paste Contents in Place
app.executeMenuCommand('paste');


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// Artboard fit to Art
app.activeDocument.fitArtboardToSelectedArt(0);


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// Set Color to RGB
app.executeMenuCommand("doc-color-rgb");




//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// Add Prefix to artboards Prompt
var doc = app.activeDocument;

newName = prompt("Add Prefix: ", "");

for (var i = 0; i < doc.artboards.length; i++) {
    var aBoard = doc.artboards[i].active;
    var oldName = doc.artboards[i].name;
    doc.artboards[i].name = newName;
}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// Create Folder //
var startFolder = Folder("~/Desktop");
var foldersToMake = ["_Ai-Exports"];
var thisNewFolder, thisNewFolderName;
for (var i = 0; i < foldersToMake.length; i++) {
    thisNewFolderName = foldersToMake[i];
    // automatically converts from Folder object to string using toString() method automatically
    thisNewFolder = Folder(startFolder + "/" + thisNewFolderName + "/" + newName);
    // not sure if this is necessary, but probably good to check it it already exists.
    if (!(thisNewFolder.exists)) {
        thisNewFolder.create();
    }
}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// Save-As
var doc = app.activeDocument;

var original_file = doc.fullName; // we need this to return to original file

var arr = doc.name.split(".");

var extension = "";

if (arr.length > 1) extension = "." + arr.pop();

var name_ai = "_PDe-" + newName + '.ai';

// This saves directly to ~/Desktop
// var export_folder = "~/Desktop/_Ai-Exports"; // define the place where to save the copy
var export_folder = thisNewFolder; // define the place where to save the copy


// This allows user to choose desitination
// var export_folder = Folder.selectDialog('Select folder.', '~/desktop')


saveCopyAsAI(name_ai);

function saveCopyAsAI(nameAI) {

    var packaged_file = null;

    packaged_file = File(export_folder + "/" + nameAI);

    var save_options = new IllustratorSaveOptions();

    save_options.embedICCProfile = true;

    save_options.pdfCompatible = true

    doc.saveAs(packaged_file, save_options);

    // alert('File Saved!');

}